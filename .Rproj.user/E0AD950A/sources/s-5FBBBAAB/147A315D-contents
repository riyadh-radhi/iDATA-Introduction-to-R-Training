# Loading Packages

library(readr) #to read the data
library(here) # to better deal with folders paths
library(dplyr) #to manipulate the data

#reading data ----

df <- read_csv(here("data", "Arab_Barometer_Wave_6_Part_3_ENG_RELEASE.csv"))

#sourcing the functions

source(here("code","functions_in_r.R"))
#data cleaning ----

df |>
  #selecting Iraq
  filter(COUNTRY %in% 7) |> 
  #selecting gender column + gender norms theme
  select(Q1002,Q601_1:Q601A) |> 
  mutate(Q1002 = case_when(Q1002 %in% 1 ~ "Male",
                           Q1002 %in% 2 ~ "Female",
                           TRUE ~ as.character(Q1002))) |> 
  rename("A woman can become President or Prime Minister of a Muslim country." = "Q601_1",
         "University education for males is more important than university education for females." = "Q601_4",
         "All primary and secondary schools should be coeducational (i.e. not separating girls from boys)" = "Q601_19"
         ) -> filtered_df

#calling our function only one time
cleaning_plotting(data = filtered_df,
                  variable = "All primary and secondary schools should be coeducational (i.e. not separating girls from boys)")

#looping over our variables to call our function
# more than one time

our_variables <- colnames(filtered_df)[c(2,3,4)]
for(looping_variable in our_variables){
  
  temprorary_plot <- cleaning_plotting(data = filtered_df,
                          variable = looping_variable)
  
  print(temprorary_plot)
}
